"use strict";var u=Object.defineProperty;var h=(a,t,i)=>t in a?u(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;var s=(a,t,i)=>(h(a,typeof t!="symbol"?t+"":t,i),i);Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const m={fontFamily:"Arial",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontSize:"14px",color:"#c1c1c1",id:"watermark",text:"Watermark",density:100,clarity:2,zIndex:1,duration:1e3,supportTip:"\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301Canvas"};class g{constructor(t){s(this,"watermarkConfig");this.watermarkConfig=Object.assign(m,t),this.init(),this._setAntiDeletion()}resetText(t){this.watermarkConfig.text=t,this.init()}_setAntiDeletion(){let t=this;window.setInterval(function(){document.getElementById(t.watermarkConfig.id+"-canvas")||t.init()},this.watermarkConfig.duration)}init(){this.createCanvas(),this.fill()}createCanvas(){let t=document.getElementById(this.watermarkConfig.id);if(!t){this.watermarkConfig.supportTip="\u65E0\u6CD5\u5B9A\u4F4D\u6C34\u5370\u8282\u70B9";return}t.style.cssText=t.style.cssText+"position: relative;";let i=t.offsetWidth,r=t.offsetHeight,e=document.createElement("canvas");e.setAttribute("id",this.watermarkConfig.id+"-canvas"),e.innerHTML=this.watermarkConfig.supportTip,e.width=i*this.watermarkConfig.clarity,e.height=r*this.watermarkConfig.clarity,e.style.cssText=`position:absolute;width: 100%;height: 100%;left:0;top:0;z-index: ${this.watermarkConfig.zIndex}`,t.appendChild(e)}fill(){let t=10,i=document.getElementById(this.watermarkConfig.id+"-canvas"),r=document.getElementById(this.watermarkConfig.id);if(!i||!r){this.watermarkConfig.supportTip="\u65E0\u6CD5\u5B9A\u4F4D\u6C34\u5370\u8282\u70B9";return}let e=i.getContext("2d");if(!e){this.watermarkConfig.supportTip="\u65E0\u6CD5\u5B9A\u4F4D\u6C34\u5370\u8282\u70B9";return}let f=r.offsetWidth*this.watermarkConfig.clarity/this.watermarkConfig.density+t,l=r.offsetHeight*this.watermarkConfig.clarity*1.5/this.watermarkConfig.density;e.rotate(-15*Math.PI/180);for(let n=0;n<f;n++)for(let o=0;o<l;o++)e.fillStyle=this.watermarkConfig.color,e.font=this.watermarkConfig.fontStyle+" "+this.watermarkConfig.fontVariant+" "+this.watermarkConfig.fontWeight+" "+this.watermarkConfig.fontSize+" "+this.watermarkConfig.fontFamily+" ",e.fillText(this.watermarkConfig.text,this.watermarkConfig.density*(n-t/2),o*this.watermarkConfig.density)}}exports.Watermark=g;
