module.exports=class{constructor(a){this.params=Object.assign({fontFamily:'Arial',fontStyle:'normal',fontVariant:'normal',fontWeight:'normal',fontSize:'14px',color:'#c1c1c1',id:'watermark',text:'Watermark',density:100,clarity:2,zIndex:1,supportTip:'\u60A8\u7684\u6D4F\u89C8\u5668\u4E0D\u652F\u6301Canvas'},a),this._init(),this._intervalometer()}resetText(a){this.params.text=a,this._init()}_intervalometer(){let a=this;window.setInterval(function(){document.getElementById(a.params.id+'-canvas')||a._init()},1e3)}_init(){this._createCanvas(),this._fill()}_createCanvas(){let a=document.getElementById(this.params.id);a||(this.params.supportTip='\u65E0\u6CD5\u5B9A\u4F4D\u6C34\u5370\u8282\u70B9'),a.style.cssText+='position: relative;';let b=a.offsetWidth,c=a.offsetHeight,d=document.createElement('canvas');d.setAttribute('id',this.params.id+'-canvas'),d.innerHTML=this.params.supportTip,d.width=b*this.params.clarity,d.height=c*this.params.clarity,d.style.cssText='position: absolute;width: 100%;height: 100%;left:0;top:0;z-index: '+this.params.zIndex+';',a.appendChild(d)}_fill(){let a=document.getElementById(this.params.id+'-canvas'),b=document.getElementById(this.params.id),c=a.getContext('2d'),d=b.offsetWidth*this.params.clarity/this.params.density+10,e=1.5*(b.offsetHeight*this.params.clarity)/this.params.density;c.rotate(-15*Math.PI/180);for(let a=0;a<d;a++)for(let b=0;b<e;b++)c.fillStyle=this.params.color,c.font=this.params.fontStyle+' '+this.params.fontVariant+' '+this.params.fontWeight+' '+this.params.fontSize+' '+this.params.fontFamily+' ',c.fillText(this.params.text,this.params.density*(a-5),b*this.params.density)}};